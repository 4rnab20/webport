<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Arnab Das">
<meta name="dcterms.date" content="2021-05-01">

<title>Arnab Das - Pulsar Star Classification</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../adlogo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Arnab Das</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../project.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../visuals.html"> 
<span class="menu-text">Visualizations</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Pulsar Star Classification</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Arnab Das </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 1, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods-and-results" id="toc-methods-and-results" class="nav-link" data-scroll-target="#methods-and-results">Methods and Results</a>
  <ul class="collapse">
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">Data Visualization</a></li>
  <li><a href="#k-nearest-neighbors-analysis" id="toc-k-nearest-neighbors-analysis" class="nav-link" data-scroll-target="#k-nearest-neighbors-analysis">K-Nearest Neighbors Analysis</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#works-cited" id="toc-works-cited" class="nav-link" data-scroll-target="#works-cited">Works cited</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kknn)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(themis)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tune)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Neutron stars are high-density celestial bodies caused by a large mass star collapsing on itself due to its own gravity (Goldberger, 2019). Pulsars are a classification of neutron stars which “pulse” or emit electromagnetic radiation periodically because of its high rotational velocity and strong magnetic fields. Telescopes on Earth can measure the continuous pulses of radio frequencies emitted by pulsars (Rodriguez, 2019). Identifying pulsar signals among interference and noise can be difficult, so machine learning can be used to predict target pulsars based on their recorded metrics.</p>
<p>Because the pulsar produces periodic pulsation signals they are often too weak to detect (Liu, 2017). Preprocessing this time series by folding the data with respect to the rotational period of the pulsar, yields a unique and distinguishable pulsar fingerprint referred to as an integrated pulse profile. The profile shape has an increased signal quality and form, and through long term observations are considered generally stable, as opposed to the highly variable single pulses (Liu, 2017).</p>
<p>However, before signals reach earth, they must pass through interstellar medium (ISM). This medium consists of everything that could possibly exist between a pulsar and the Earth (Liu, 2017). There are several major effects on pulsar radio signals, namely dispersion, scintillation, and scattering (Grootjans 2016), but for the purpose of this report only dispersion will be explored. The pulsar signal can be considered a plane wave whose frequency depends on interactions between ionized components of the ISM (Grootjans, 2016).The frequency dependence of these waves causes higher frequency waves to arrive earlier and lower frequency waves to arrive later, by an amount defined by a dispersion measure (DM) (Liu, 2017). The DM of any frequency is also proportional to the distance of the pulsar. All these factors result in the broadening and reducing the peak values for the frequency distribution curve of a pulsar. When a sufficient amount of dispersion is present in the signal, a signal-to-noise ratio (SNR) preprocessing (taking into consideration antenna aperture and other properties relevant to noise) must be applied to further analyze the pulsar curve by fitting the data (Grootjans, 2016). By applying this filter, a DM-SNR curve can be produced which has removed dispersion distortions in pulse shapes.</p>
<p>In the “Predicted Pulsar Star” Kaggle dataset, an integrated profile and a DM-SNR curve is considered. These two preprocessed measurements have tabulated results for the following statistics: mean, standard deviation, excess kurtosis, and skewness of these measurements. Excess kurtosis describes the tails on a normal distribution to measure the probability of events occurring outside of the normal range, unlike skewness which refers to the symmetry of a normal distribution. In our dataset, our target_class has been identified by binary classification, where a value of 1 represents a pulsar, and the value of 0 represents a non-pulsar.</p>
<p>In this project we will explore how a star’s integrated and DM-SNR profiles affect the accuracy of K-Nearest Neighbors classification models based on these two profiles. The question we aim to answer is: can DM-SNR curve and integrated profile measurements predict pulsar stars? If so, which preprocessing technique yields the most accurate model? We hypothesize that the model built using DM-SNR curve measurements will yield the most accurate model, because it takes into account the noise of space, which is a common source of error when star signals are recorded.</p>
</section>
<section id="methods-and-results" class="level2">
<h2 class="anchored" data-anchor-id="methods-and-results">Methods and Results</h2>
<p>We’ll start by downloading the data set and reading it into a dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load training data from Kaggle</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pulsar_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"pulsar_data_train.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update column names to be more 'code-friendly'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pulsar_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mean_integrated"</span>, <span class="st">"stdev_integrated"</span>, <span class="st">"kurtosis_integrated"</span>, <span class="st">"skew_integrated"</span>, <span class="st">"mean_DMSNR"</span>, <span class="st">"stdev_DMSNR"</span>, <span class="st">"kurtosis_DMSNR"</span>, <span class="st">"skew_DMSNR"</span>, <span class="st">"class"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Covert target class to factor</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>pulsar_data <span class="ot">&lt;-</span> pulsar_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">class=</span><span class="fu">as_factor</span>(class))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load testing file from Kaggle</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>pulsar_test_unclass <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"pulsar_data_test.csv"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Update column names to be more 'code friendly'</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pulsar_test_unclass) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mean_integrated"</span>, <span class="st">"stdev_integrated"</span>, <span class="st">"kurtosis_integrated"</span>, <span class="st">"skew_integrated"</span>, <span class="st">"mean_DMSNR"</span>, <span class="st">"stdev_DMSNR"</span>, <span class="st">"kurtosis_DMSNR"</span>, <span class="st">"skew_DMSNR"</span>, <span class="st">"class"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pulsar_test_unclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> mean_integrated  stdev_integrated kurtosis_integrated skew_integrated  
 Min.   :  6.18   Min.   :24.79    Min.   :-1.8760     Min.   :-1.7647  
 1st Qu.:101.04   1st Qu.:42.41    1st Qu.: 0.0306     1st Qu.:-0.1896  
 Median :114.76   Median :47.03    Median : 0.2273     Median : 0.1865  
 Mean   :111.17   Mean   :46.62    Mean   : 0.4837     Mean   : 1.7513  
 3rd Qu.:127.02   3rd Qu.:51.13    3rd Qu.: 0.4751     3rd Qu.: 0.9188  
 Max.   :192.62   Max.   :98.78    Max.   : 7.6084     Max.   :65.3860  
                                   NA's   :767                          
   mean_DMSNR        stdev_DMSNR     kurtosis_DMSNR     skew_DMSNR      
 Min.   :  0.2132   Min.   :  7.37   Min.   :-2.722   Min.   :  -1.965  
 1st Qu.:  1.9565   1st Qu.: 14.56   1st Qu.: 5.700   1st Qu.:  33.817  
 Median :  2.8307   Median : 18.55   Median : 8.384   Median :  81.392  
 Mean   : 12.4736   Mean   : 26.43   Mean   : 8.234   Mean   : 102.869  
 3rd Qu.:  5.5903   3rd Qu.: 28.68   3rd Qu.:10.632   3rd Qu.: 136.893  
 Max.   :223.3921   Max.   :109.71   Max.   :34.540   Max.   :1191.001  
                    NA's   :524                       NA's   :244       
  class        
 Mode:logical  
 NA's:5370     
               
               
               
               
               </code></pre>
</div>
</div>
<p>We can see that the test dataset doesn’t have any target classes. So, this dataset is not useful to us in training/testing our model, and we will need to split the training dataset.</p>
<p>We will split the pulsar data set into training and testing sets. The testing set will not be touched until the model is ready for evaluation. We are splitting the data into 75% training and 25% testing because the dataset is sufficiently large (~9,000 observations) that leaving 25% of the data for testing is enough to accurately assess the performance of our model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into training and testing set</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine how many rows have missing values.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>num_rows_missing_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">apply</span>(pulsar_data, <span class="dv">1</span>, anyNA))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of rows with missing values: 3183</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For our predictions down the road, we need to remove rows with NA values from the test set</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>pulsar_omit_na <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(pulsar_data) <span class="co">#this is so our KNN model will run properly later</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>pulsar_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(pulsar_omit_na, <span class="at">prop =</span> <span class="fl">0.75</span>, <span class="at">strata =</span> class)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>pulsar_train <span class="ot">&lt;-</span> <span class="fu">training</span>(pulsar_split)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>pulsar_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(pulsar_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="exploratory-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(pulsar_train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">mean_integrated</th>
<th style="text-align: right;">stdev_integrated</th>
<th style="text-align: right;">kurtosis_integrated</th>
<th style="text-align: right;">skew_integrated</th>
<th style="text-align: right;">mean_DMSNR</th>
<th style="text-align: right;">stdev_DMSNR</th>
<th style="text-align: right;">kurtosis_DMSNR</th>
<th style="text-align: right;">skew_DMSNR</th>
<th style="text-align: left;">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">121.15625</td>
<td style="text-align: right;">48.37297</td>
<td style="text-align: right;">0.3754847</td>
<td style="text-align: right;">-0.0131655</td>
<td style="text-align: right;">3.168896</td>
<td style="text-align: right;">18.39937</td>
<td style="text-align: right;">7.449874</td>
<td style="text-align: right;">65.15930</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">76.96875</td>
<td style="text-align: right;">36.17556</td>
<td style="text-align: right;">0.7128979</td>
<td style="text-align: right;">3.3887186</td>
<td style="text-align: right;">2.399666</td>
<td style="text-align: right;">17.57100</td>
<td style="text-align: right;">9.414652</td>
<td style="text-align: right;">102.72297</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">130.58594</td>
<td style="text-align: right;">53.22953</td>
<td style="text-align: right;">0.1334083</td>
<td style="text-align: right;">-0.2972416</td>
<td style="text-align: right;">2.743311</td>
<td style="text-align: right;">22.36255</td>
<td style="text-align: right;">8.508364</td>
<td style="text-align: right;">74.03132</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">109.40625</td>
<td style="text-align: right;">55.91252</td>
<td style="text-align: right;">0.5651059</td>
<td style="text-align: right;">0.0562467</td>
<td style="text-align: right;">2.797659</td>
<td style="text-align: right;">19.49653</td>
<td style="text-align: right;">9.443282</td>
<td style="text-align: right;">97.37458</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">95.00781</td>
<td style="text-align: right;">40.21981</td>
<td style="text-align: right;">0.3475781</td>
<td style="text-align: right;">1.1531644</td>
<td style="text-align: right;">2.770067</td>
<td style="text-align: right;">18.21774</td>
<td style="text-align: right;">7.851205</td>
<td style="text-align: right;">70.80194</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">130.08594</td>
<td style="text-align: right;">46.40262</td>
<td style="text-align: right;">-0.0465848</td>
<td style="text-align: right;">-0.0344684</td>
<td style="text-align: right;">5.050167</td>
<td style="text-align: right;">27.99748</td>
<td style="text-align: right;">6.059849</td>
<td style="text-align: right;">38.15479</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are eight predictive variables and one target variable. The predictors are composed of two groups of readings: the integrated profile and the DMSNR profile. Each group has the same four measurements: mean, standard deviation, kurtosis, and skew. We will use descriptive statistics and visualizations to explore the differences between the two profiles in order to determine which predictors will be most useful for our model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number and percentage of observations that are pulsar stars.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>num_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(pulsar_train)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>class_dist <span class="ot">&lt;-</span> pulsar_train <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">percentage=</span><span class="fu">n</span>()<span class="sc">/</span>num_obs<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>class_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  class     n percentage
  &lt;fct&gt; &lt;int&gt;      &lt;dbl&gt;
1 0      6301      90.6 
2 1       653       9.39</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#class 0 (non-pulsar stars): 90.8% of the data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#class 1 (pulsar stars): 9.2% of the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We will also calculate the mean of the predictors in the dataset.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mean of the predictors</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>predictor_means <span class="ot">&lt;-</span> pulsar_train <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>class) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>predictor_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  mean_integrated stdev_integrated kurtosis_integrated skew_integrated
            &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;           &lt;dbl&gt;
1            111.             46.5               0.482            1.80
# ℹ 4 more variables: mean_DMSNR &lt;dbl&gt;, stdev_DMSNR &lt;dbl&gt;,
#   kurtosis_DMSNR &lt;dbl&gt;, skew_DMSNR &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#now, let's omit rows with NA values.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pulsar_train <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(pulsar_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The predictors’ scale varies significantly, as evidenced by the calculated means. Since the k-nn classification algorithm is particularly sensitive to predictors with larger values, we need to scale and center the data before building the model. This ensures that predictors with larger values (e.g.&nbsp;mean of the integrated profile) don’t have a disproportionate effect on the classification model.</p>
</section>
<section id="data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="data-visualization">Data Visualization</h3>
<p>Visualizing the data can give us an idea of the distribution of predictors, and may give us an indication of which predictors will be most useful in the creation of our model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> pulsar_train <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(class, mean_integrated, stdev_integrated, kurtosis_integrated, skew_integrated), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(data_long<span class="sc">$</span>Variable, <span class="st">"_DMSNR"</span>, <span class="st">""</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">15</span>, <span class="at">repr.plot.height =</span> <span class="dv">10</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>intdensity_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"DMSNR"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e64186"</span>, <span class="st">"#672e8c"</span>, <span class="st">"#2d3569"</span>, <span class="st">"#c68dd8"</span>))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                                                        </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>data_long1 <span class="ot">&lt;-</span> pulsar_train <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(class, mean_DMSNR, stdev_DMSNR, kurtosis_DMSNR, skew_DMSNR), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>data_long1<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(data_long1<span class="sc">$</span>Variable, <span class="st">"_integrated"</span>, <span class="st">""</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>DMSNRdensity_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long1, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Integrated"</span>) <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e64186"</span>, <span class="st">"#672e8c"</span>, <span class="st">"#2d3569"</span>, <span class="st">"#c68dd8"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Kurtosis"</span>, <span class="st">"Mean"</span>, <span class="st">"Skewness"</span>, <span class="st">"Standard Deviation"</span>))</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>combine_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(intdensity_plot, DMSNRdensity_plot, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">"Density plots"</span>, <span class="at">fontface=</span><span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">25</span>), combine_plot, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">rel_heights=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<p>These distributions provide insights into the characteristics of the data for each variable, including the presence of outliers, the symmetry of the data, and the concentration of values. The skewness and kurtosis specifically provide information about the shape of the distribution, which can be useful in understanding the underlying patterns in the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To visualize the distribution of pulsar vs non-pulsar stars, we can use a bar chart.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>class_plot <span class="ot">&lt;-</span> <span class="fu">subset</span>(class_dist, <span class="sc">!</span><span class="fu">is.na</span>(class)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>class, <span class="at">y=</span>n, <span class="at">fill=</span>class)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Class"</span>)<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequencies of target classes"</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Purples"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"non-pulsar"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"pulsar"</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>class_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<p>There are significantly more observations in the non-pulsar (0) than pulsar (1) class. Imbalanced data can result in the model inappropriately preferring the more common class. In order to account for this imbalance, we will need to upsample the pulsar class to produce an accurate model (see methods for more details on how this is done).</p>
<p>To visualize the relationship between predictors and the target class, we can create violin plots of each predictor variable stratified by target class. Unlike boxplots, violin plots allow us to visualize both the distribution and density of the underlying data. This additional detail about the data will help with our intuition when it comes to selecting predictors for our model.</p>
<p>Using those plots, we can see which predictors vary most between the two target classes, and between integrated and DM-SNR.</p>
<p>The data needs to be tidied before the violin plots can be created. Specifically, we will be moving the values of each of the predictors from their own columns into key-value pairs using the gather function.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tidy_stars <span class="ot">&lt;-</span> pulsar_train <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gather</span>(<span class="at">key=</span>profile, <span class="at">value=</span>value, mean_integrated, stdev_integrated, kurtosis_integrated, skew_integrated,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mean_DMSNR, stdev_DMSNR, kurtosis_DMSNR, skew_DMSNR)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(tidy_stars))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">class</th>
<th style="text-align: left;">profile</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">121.15625</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">76.96875</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">130.58594</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">109.40625</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">95.00781</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">mean_integrated</td>
<td style="text-align: right;">130.08594</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make violin plots comparing DM-SNR Curve and Integrated Profile variables, to see how they differ</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># between our target classes</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy the data to generate a profile column</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean violin</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>mean_violin <span class="ot">&lt;-</span>  tidy_stars <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(profile<span class="sc">==</span><span class="st">"mean_integrated"</span><span class="sc">|</span>profile<span class="sc">==</span><span class="st">"mean_DMSNR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>profile, <span class="at">y=</span>value), <span class="at">trim=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>class), <span class="at">draw_quantiles=</span><span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Target class"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean Value"</span>)<span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"Class"</span>, <span class="at">title=</span><span class="st">"Mean"</span>)<span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Reds"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"non-pulsar"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"pulsar"</span>))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># sd violin</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  sd_violin <span class="ot">&lt;-</span>  tidy_stars <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(profile<span class="sc">==</span><span class="st">"stdev_integrated"</span><span class="sc">|</span>profile<span class="sc">==</span><span class="st">"stdev_DMSNR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>profile, <span class="at">y=</span>value), <span class="at">trim=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>class), <span class="at">draw_quantiles=</span><span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">colour =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Profile"</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"SD Value"</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"Class"</span>, <span class="at">title=</span><span class="st">"Standard Deviation"</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"PuRd"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"non-pulsar"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"pulsar"</span>))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co"># kurtosis violin</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>kurtosis_violin <span class="ot">&lt;-</span>  tidy_stars <span class="sc">%&gt;%</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(profile<span class="sc">==</span><span class="st">"kurtosis_integrated"</span><span class="sc">|</span>profile<span class="sc">==</span><span class="st">"kurtosis_DMSNR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>profile, <span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>class), <span class="at">draw_quantiles=</span><span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">colour =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Profile"</span>) <span class="sc">+</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Kurtosis Value"</span>)<span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"Class"</span>, <span class="at">title=</span><span class="st">"Kurtosis"</span>)<span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"non-pulsar"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"pulsar"</span>))</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co"># skew_violin</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>skew_violin <span class="ot">&lt;-</span>  tidy_stars <span class="sc">%&gt;%</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(profile<span class="sc">==</span><span class="st">"skew_integrated"</span><span class="sc">|</span>profile<span class="sc">==</span><span class="st">"skew_DMSNR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>profile, <span class="at">y=</span>value), <span class="at">draw_quantiles=</span><span class="fu">c</span>(<span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>class), <span class="at">colour =</span> <span class="st">"darkgreen"</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Profile"</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Skew Value"</span>)<span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"Class"</span>, <span class="at">title=</span><span class="st">"Skew"</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"non-pulsar"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"pulsar"</span>))</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(mean_violin, sd_violin, kurtosis_violin, skew_violin, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">"Class Across Key Factors"</span>, <span class="at">fontface=</span><span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">25</span>), combined_plot, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">rel_heights=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Figures 2-5 are violin plots of the four types of measurements that were collected (mean, standard deviation, kurtosis, and skew), stratified by target class and profile (integrated vs DMSNR). These plots allow us to determine which predictors will be most useful for building our classification model.</p>
<p>Firstly, it demonstrates how the predictors vary between the two target classes. A predictor whose distribution varies significantly between the target classes (for example, in Figure 3), is likely to be more useful for our classification model than a predictor with very similar distributions.</p>
<p>Secondly, these plots demonstrate the difference between the integrated and DMSNR profiles. We can see which profile varies more between the two target classes, thus allowing us to predict which profile will be more useful for building classification models.</p>
<p>We can see that while each predictor is extremely different depending on whether it is from the integrated or DM-SNR profile, all groups show a difference in the distribution and mean of the target classes within the same variable. So, each would be a useful addition to their respective models. As well, from a broader perspective, we want to use all of the scientific data available to us, since it was painstakingly collected and cleaned, and omission of a particular variable without reasonable grounds could cause us to lose accuracy in our models.</p>
</section>
<section id="k-nearest-neighbors-analysis" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-analysis">K-Nearest Neighbors Analysis</h3>
<p>After our preliminary analysis, our next step will be to use our integrated and DM-SNR variables to predict pulsar stars using the K-Nearest Neighbors classification algorithm.</p>
<p>This will help us determine whether one of these two recording techniques is better than the other at distinguishing pulsar stars from the noise of space.</p>
<p>Our first step is to set up our KNN model, using the integrated variables. We will do this in several steps. 1. Make a recipe. The recipe will preprocess our data by centering and scaling our predictors (since the ranges of our predictors differ), and upsample our target class (since it is ~90% target class 0). 2. Make a KNN spec, to tell the computer to run KNN (and with what parameters). This will include the neighbors=tune() function so we can find the value of K that gives us the highest accuracy. 3. Make our cross validation sets, so we can test our tuning model and find accuracies of different K’s. 4. Make a tuning workflow, to tune the KNN model and find the value of K giving the highest accuracy.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1. First, we make our recipe, which will preprocess our data.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>recipe_integrated <span class="ot">&lt;-</span> <span class="fu">recipe</span>(class <span class="sc">~</span> mean_integrated <span class="sc">+</span> stdev_integrated <span class="sc">+</span> kurtosis_integrated <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>skew_integrated, <span class="at">data =</span> pulsar_train) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_scale</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_center</span>(<span class="fu">all_predictors</span>())<span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_upsample</span>(class, <span class="at">over_ratio=</span><span class="dv">1</span>, <span class="at">skip=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>recipe_integrated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2. Next, we will create our model, so the computer knows how to run the KNN</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>knn_tune <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">weight_func =</span> <span class="st">"rectangular"</span>, <span class="at">neighbors =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_engine</span>(<span class="st">"kknn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#3. next, we make our cross-validation set to test iterations of K</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vfold <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(pulsar_train, <span class="at">v =</span> <span class="dv">5</span>, <span class="at">strata =</span> class)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#4. now, we make a workflow to find the best value of K, to give our training model the best accuracy.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_recipe</span>(recipe_integrated) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_model</span>(knn_tune) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tune_grid</span>(<span class="at">resamples =</span> vfold, <span class="at">grid =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">collect_metrics</span>()</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">#note: grid=20 to test 20 values of K, rather than the usual 10</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#This is so we can confidently find the value of K with the highest accuracy by being more rigorous with our testing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now that our model has been tuned, we can pull the accuracy of our tuning model for each iteration of K, and plot it to show how accuracy changes depending on K.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pull accuracies</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>accuracies <span class="ot">&lt;-</span> knn_fit <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"accuracy"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot accuracy against K</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>cross_val_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(accuracies, <span class="fu">aes</span>(<span class="at">x =</span> neighbors , <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Neighbours"</span>, <span class="at">y =</span> <span class="st">"Accuracy Estimate"</span>, <span class="at">title =</span> <span class="st">"Integrated profile model accuracy"</span>)  <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>cross_val_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>According to the plot above, the value of K that gives the highest accuracy is K=2. We will now make another model that uses this value of K to predict the class of a testing set. This will require us to make a new KNN spec and workflow- but we can reuse our old recipe, since it isn’t affected by choosing K.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pull the value of K giving the highest accuracy (2)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>kn_integrated <span class="ot">&lt;-</span> knn_fit <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"accuracy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">arrange</span>(<span class="fu">desc</span>(mean)) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">pull</span>(neighbors)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>kn_integrated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make another KNN spec, this time with neighbors= our chosen value of K</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>int_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">weight_func =</span> <span class="st">"rectangular"</span>, <span class="at">neighbors =</span> kn_integrated) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_engine</span>(<span class="st">"kknn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#make the workflow to build our final model</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>int_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">add_recipe</span>(recipe_integrated) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">add_model</span>(int_spec) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">fit</span>(<span class="at">data =</span> pulsar_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now that we’ve build our final model, we can test it using data it hasn’t seen before, i.e.&nbsp;our testing set. This will tell us its overall accuracy in predicting the class of an unknown star, and how good it is at predicting pulsar stars specifically. Once we have predicted the testing set, we can gather its metrics to see its accuracy, and plot it as a confusion matrix to see how many times it predicted each class correctly, and incorrectly.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predict the testing set using our integrated model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>int_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(int_fit, pulsar_test) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(pulsar_test)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#get the accuracy of our model at predicting the test class</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>int_metrics <span class="ot">&lt;-</span> int_pred <span class="sc">%&gt;%</span> <span class="fu">metrics</span>(<span class="at">truth =</span> class, <span class="at">estimate=</span>.pred_class)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate confusion matrix</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>int_mat <span class="ot">&lt;-</span> int_pred <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> class, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert confusion matrix to data frame</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>int_mat_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(int_mat<span class="sc">$</span>table)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix using ggplot2</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(int_mat_df, <span class="fu">aes</span>(<span class="at">x =</span> Truth, <span class="at">y =</span> Prediction, <span class="at">fill =</span> <span class="fu">factor</span>(Freq))) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confusion Matrix"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Class"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Class"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tidy_int_mat <span class="ot">&lt;-</span> <span class="fu">tidy</span>(int_mat) <span class="co">#this is for later</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are finished with our integrated model, and can begin making our DM-SNR model. This will follow the same steps as above. Firstly, we will set up a recipe to tune the value of K to that which gives the highest accuracy of our training model. To do this, we will: 1. Make a new recipe. 2. Reuse our old KNN spec (since it doesn’t depend on our variables) 3. Reuse our old cross validation sets (since they don’t depend on our variables) 4. Make a tuning workflow, to find the best value of K.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make the recipe</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>recipe_DMSNR <span class="ot">&lt;-</span> <span class="fu">recipe</span>(class <span class="sc">~</span> mean_DMSNR <span class="sc">+</span> stdev_DMSNR <span class="sc">+</span> kurtosis_DMSNR <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>skew_DMSNR, <span class="at">data =</span> pulsar_train) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_scale</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_center</span>(<span class="fu">all_predictors</span>())<span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_upsample</span>(class, <span class="at">over_ratio=</span><span class="dv">1</span>, <span class="at">skip=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#reuse KNN spec and cross validation sets</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#make our tuning workflow</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_recipe</span>(recipe_DMSNR) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_model</span>(knn_tune) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tune_grid</span>(<span class="at">resamples =</span> vfold, <span class="at">grid =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="co">#note: grid=20 to test 20 values of K, rather than the usual 10</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With our DM-SNR tuning workflow, we can pull the accuracies of each K in our tuning model, and plot them to see how accuracy depends on K.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pull accuracies</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>accuracies <span class="ot">&lt;-</span> knn_fit <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"accuracy"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#make the plot</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>cross_val_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(accuracies, <span class="fu">aes</span>(<span class="at">x =</span> neighbors , <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Neighbours"</span>, <span class="at">y =</span> <span class="st">"Accuracy Estimate"</span>, <span class="at">title =</span> <span class="st">"DM-SNR profile model accuracy"</span>)  <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>cross_val_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot tells that the value of K giving the highest accuracy of our training model is K=1. We will pull that value, and use it to build a new model to predict our testing set (and other unknown stars). We can reuse our old recipe and build a new KNN spec for our best value of K (value of K giving the highest accuracy), and a new workflow for our final DM-SNR model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>kn_DMSNR <span class="ot">&lt;-</span> knn_fit <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"accuracy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">arrange</span>(<span class="fu">desc</span>(mean)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">pull</span>(neighbors)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#make new KNN spec with best value of K</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>DMSNR_int_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">weight_func =</span> <span class="st">"rectangular"</span>, <span class="at">neighbors =</span> kn_DMSNR) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_engine</span>(<span class="st">"kknn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#make final workflow</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>DMSNR_int_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">add_recipe</span>(recipe_DMSNR) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">add_model</span>(DMSNR_int_spec) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">fit</span>(<span class="at">data =</span> pulsar_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now that our final DM-SNR model is built, we will test it on data it hasn’t seen before (the testing set) to find its accuracy. We can pull the overall accuracy of the model using the metrics() function, and use a confusion matrix to show how many times our model correctly and incorrectly identified the class of the stars by comparing their true and predicted class.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Predict the testing data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>DMSNR_int_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(DMSNR_int_fit, pulsar_test) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">bind_cols</span>(pulsar_test)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get the accuracy of our model at predicting the classes of the test data</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>DMSNR_int_metrics <span class="ot">&lt;-</span> DMSNR_int_pred <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(<span class="at">truth =</span> class, <span class="at">estimate=</span>.pred_class)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#make a confusion matrix</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>DMSNR_mat <span class="ot">&lt;-</span> DMSNR_int_pred <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">conf_mat</span>(<span class="at">truth =</span> class, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert confusion matrix to data frame</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>DMSNR_mat_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(DMSNR_mat<span class="sc">$</span>table)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix using ggplot2</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DMSNR_mat_df, <span class="fu">aes</span>(<span class="at">x =</span> Truth, <span class="at">y =</span> Prediction, <span class="at">fill =</span> <span class="fu">factor</span>(Freq))) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confusion Matrix"</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Class"</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Class"</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Purples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tidy_DMSNR_mat <span class="ot">&lt;-</span> <span class="fu">tidy</span>(DMSNR_mat)<span class="co">#this is for later</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, to display our data we will make a grouped bar chart, showing both the overall accuracy and the accuracy of predicting pulsar stars (the true positive rate). It is important for us to look at overall accuracy and pulsar star classification accuracy because while we do want a model that has a high overall accuracy, our goal is to find the model that is the best at predicting pular stars (not just non-pulsars), so we need to compare both metrics of our models. We will also calculate a false positive rate, as the goal of our project is to correctly identify pulsar stars - so while a false negative (classifying a pulsar as a non-pulsar star) is not ideal, it is not as detrimental as false positives (classifying a non-pulsar as a pulsar) as this affects our ability to gain accurate knowledge on pulsar stars using our model.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gather the values from our accuracy estimates</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gather overall accuracy estimates from our two models</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>DMSNR_accuracy <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(DMSNR_int_metrics[<span class="dv">1</span>, <span class="dv">3</span>])<span class="sc">*</span><span class="dv">100</span> <span class="co">#92.3%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>integrated_accuracy <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(int_metrics[<span class="dv">1</span>, <span class="dv">3</span>])<span class="sc">*</span><span class="dv">100</span> <span class="co">#96.8%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#gather accuracy estimates of pulsar stars only from our confusian matrices</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#this is correctly identified pulsars/ total number of true pulsars *100</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>pulsar_integrated <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">4</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>(<span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">3</span>,<span class="dv">2</span>])<span class="sc">+</span><span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">4</span>,<span class="dv">2</span>]))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>pulsar_integrated <span class="co">#77.5%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.72589</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pulsar_DMSNR <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">4</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">3</span>,<span class="dv">2</span>])<span class="sc">+</span><span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">4</span>,<span class="dv">2</span>]))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>pulsar_DMSNR <span class="co">#58.0%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55.32995</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gather accuracy estimates of pulsar stars from confusion matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate false positive rate</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#this is false positive rate (0's classified as 1)/total negatives (all 0's) *100</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>integrated_falsepos <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">2</span>, <span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">1</span>, <span class="dv">2</span>])<span class="sc">+</span><span class="fu">as.numeric</span>(tidy_int_mat[<span class="dv">2</span>, <span class="dv">2</span>]))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>integrated_falsepos <span class="co">#1.2%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.403393</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>DMSNR_falsepos <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>((<span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">+</span><span class="fu">as.numeric</span>(tidy_DMSNR_mat[<span class="dv">2</span>,<span class="dv">2</span>])))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>DMSNR_falsepos <span class="co">#4.2%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.95853</code></pre>
</div>
</div>
<p>Now we can plot our accuracy estimates as a grouped bar chart.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make a new dataframe for our plot</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>accuracies <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"percent_accuracy"</span><span class="ot">=</span><span class="fu">c</span>(DMSNR_accuracy, integrated_accuracy, pulsar_integrated, pulsar_DMSNR))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"type"</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">"DMSNR"</span>, <span class="st">"Integrated"</span>, <span class="st">"Integrated"</span>, <span class="st">"DMSNR"</span>))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>subgroup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"subgroup"</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">"Overall Accuracy"</span>, <span class="st">"Overall Accuracy"</span>, <span class="st">"Pulsar Identification Accuracy"</span>, <span class="st">"Pulsar Identification Accuracy"</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>accuracy_table <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(names, accuracies, subgroup)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#make the plot</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>accuracy_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(accuracy_table, <span class="fu">aes</span>(<span class="at">x=</span>type, <span class="at">y=</span>percent_accuracy, <span class="at">fill=</span>subgroup))<span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>subgroup),<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Type of Star Recording"</span>, <span class="at">y=</span><span class="st">"Percent Accuracy of KNN Model"</span>, <span class="at">fill=</span><span class="st">"Accuracy Type"</span>, <span class="at">title=</span><span class="st">"Overall and true positive accuracy"</span>)<span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"BuGn"</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>accuracy_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>From this barchart, we observe that the overall accuracy and accuracy of pulsar star identification differs between our two models. In both, the integrated model shows higher accuracy.</p>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>We created two models using the provided metrics for the integrated and DM-SNR profiles. The first model using integrated profile predictors yielded an accuracy of 96% for all predicted classes. The second model using the DM-SNR curve predictors had a lower accuracy at 91% for all predicted classes. In addition to better overall accuracy, the integrated curve model was also more accurate when predicting true positives (i.e.&nbsp;correctly identifying pulsar stars). Out of 219 pulsar stars in our data set, the integrated curve model correctly identified 178 (78%), compared with the DM-SNR curve model which only identified 127 (58%). Clearly, the integrated model is better than the DM-SNR curve model at predicting pulsar stars from the noise of space. However, considering how rare pulsar stars are an 81% accuracy of our best model may not be good enough if it is to be used in scientific research. To elucidate this, we calculated a false positive rate for each model, as falsely identifying a non-pulsar as a pulsar star affects the quality of future research far more than missing a pulsar star due to a false negative. Our integrated model had a false positive rate of 1.2%, while our DM-SNR model had a false positive rate of 4.2%. So again we see our integrated model is better at distinguishing pulsar stars, would give better prediction accuracy for our key metrics, and is a better choice for use in classifying new stars.</p>
<p>By predicting the target class for each observation in the testing data set using the integrated model, we accurately differentiated pulsars from non-pulsars for each observation in the testing data set and could predict the class of recently recorded pulsar observations.</p>
<p>Contrary to our hypothesis that the DM-SNR curve model would be more accurate, the integrated profile model proved to be better at predicting pulsars. The reasoning for our hypothesis was that the DM-SNR curve would be a better preprocessing method which removed distortions in pulse shapes due to dispersion, in comparison to the integrated pulse profile which preprocessed the time series by folding the data with respect to the rotational period. Analyzing the integrated vs DM-SNR model’s accuracies tells us how well these recording methods can identify a pulsar star and the best variables for filtering pulsar stars from the noise of space. We used the integrated model to predict the target class for the observations in the testing dataset, differentiating pulsar stars from non-pulsars. Prediction of pulsars will be beneficial for scientists and astronomers for celestial research. Using pulsar stars, scientists can measure cosmic distances, time and search for planets beyond Earth’s solar system. Moreover, it is possible to measure how the presence of massive bodies curves space-time. By observing pulsars, the researchers have shown repeatedly that close double neutron star systems send out strong gravitational waves (Cofield 2016). Helping scientists efficiently and accurately identify pulsar stars will ultimately help advance research areas that depend on pulsar stars.</p>
<p>Now that we have demonstrated a reasonably effective model using the provided data set, the next step would be to test our model out in the real world. This will give us a better idea of how useful our model might actually be to scientists interested in identifying pulsar stars, as the competition data set we used for our model may not be entirely representative of the data typically produced by radio telescopes. We may find that additional cleaning or wrangling is needed in order to deploy our model on real-world data.</p>
<p>At the end of the data analysis, several questions may arise: - Are either of our models accurate enough for scientific research? - Is another classification model better suited to this data (e.g.&nbsp;Random Forest)? - Which predictors need more scientific advancement until they are as useful as the others? - Our best values of K were quite low. Do we need to omit variables that are adding extra variation into our models? - How accurate are the predicted labels from the model? - Can we further improve the model or method of classification?</p>
</section>
<section id="works-cited" class="level2">
<h2 class="anchored" data-anchor-id="works-cited">Works cited</h2>
<p>Cofield,C.(2016, April 22). What Are Pulsars? . https://www.space.com/32661-pulsars.html</p>
<p>Grootjans et al.&nbsp;(2016, August). Detection of Dispersed Pulsars in a Time Series by Using a Matched Filtering Approach. https://essay.utwente.nl/71435/1/GROOTJANS_MA_EWI.pdf</p>
<p>Goldberger, A. (2019, January 04). Classifying pulsar stars using AI techniques. https://medium.com/duke-ai-society-blog/classifying-pulsar-stars-using-ai-techniques-d2be70c0f691</p>
<p>Max Planck Institute, PULSE: The Impact of European Pulsar Science on Modern Physics, https://phys.org/news/2005-12-pulse-impact-european-pulsar-science.html</p>
<p>(n.d.). Ggplot2 violin plot : Quick start guide - R software and data visualization. STHDA. http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization</p>
<p>(n.d.). Violin Plot. Ggplot 2. https://ggplot2.tidyverse.org/reference/geom_violin.html</p>
<p>Rodriguez, F. (2019, October 07). Pulsar Stars Detection. https://datauab.github.io/pulsar_stars/</p>
<p>Liu K., (2017, June 26).Introduction to Pulsar, Pulsar Timing, and measuring of Pulse Time-of-Arrivals. http://ipta.phys.wvu.edu/files/student-week-2017/IPTA2017_KuoLiu_pulsartiming.pdf</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb39" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Pulsar Star Classification"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Arnab Das"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2021-05-1"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R]</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="in">library(kknn)</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="in">library(cowplot)</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="in">library(rsample)</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="in">library(themis)</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="in">library(parsnip)</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(tune)</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(workflows)</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(yardstick)</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>Neutron stars are high-density celestial bodies caused by a large mass star collapsing on itself due to its own gravity (Goldberger, 2019). Pulsars are a classification of neutron stars which "pulse" or emit electromagnetic radiation periodically because of its high rotational velocity and strong magnetic fields. Telescopes on Earth can measure the continuous pulses of radio frequencies emitted by pulsars (Rodriguez, 2019). Identifying pulsar signals among interference and noise can be difficult, so machine learning can be used to predict target pulsars based on their recorded metrics.</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>Because the pulsar produces periodic pulsation signals they are often too weak to detect (Liu, 2017). Preprocessing this time series by folding the data with respect to the rotational period of the pulsar, yields a unique and distinguishable pulsar fingerprint referred to as an integrated pulse profile. The profile shape has an increased signal quality and form, and through long term observations are considered generally stable, as opposed to the highly variable single pulses (Liu, 2017).</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>However, before signals reach earth, they must pass through interstellar medium (ISM). This medium consists of everything that could possibly exist between a pulsar and the Earth (Liu, 2017). There are several major effects on pulsar radio signals, namely dispersion, scintillation, and scattering (Grootjans 2016), but for the purpose of this report only dispersion will be explored. The pulsar signal can be considered a plane wave whose frequency depends on interactions between ionized components of the ISM (Grootjans, 2016).The frequency dependence of these waves causes higher frequency waves to arrive earlier and lower frequency waves to arrive later, by an amount defined by a dispersion measure (DM) (Liu, 2017). The DM of any frequency is also proportional to the distance of the pulsar. All these factors result in the broadening and reducing the peak values for the frequency distribution curve of a pulsar. When a sufficient amount of dispersion is present in the signal, a signal-to-noise ratio (SNR) preprocessing (taking into consideration antenna aperture and other properties relevant to noise) must be applied to further analyze the pulsar curve by fitting the data (Grootjans, 2016). By applying this filter, a DM-SNR curve can be produced which has removed dispersion distortions in pulse shapes.</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>In the "Predicted Pulsar Star" Kaggle dataset, an integrated profile and a DM-SNR curve is considered. These two preprocessed measurements have tabulated results for the following statistics: mean, standard deviation, excess kurtosis, and skewness of these measurements. Excess kurtosis describes the tails on a normal distribution to measure the probability of events occurring outside of the normal range, unlike skewness which refers to the symmetry of a normal distribution. In our dataset, our target_class has been identified by binary classification, where a value of 1 represents a pulsar, and the value of 0 represents a non-pulsar.</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>In this project we will explore how a star's integrated and DM-SNR profiles affect the accuracy of K-Nearest Neighbors classification models based on these two profiles. The question we aim to answer is: can DM-SNR curve and integrated profile measurements predict pulsar stars? If so, which preprocessing technique yields the most accurate model? We hypothesize that the model built using DM-SNR curve measurements will yield the most accurate model, because it takes into account the noise of space, which is a common source of error when star signals are recorded.</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods and Results</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>We'll start by downloading the data set and reading it into a dataframe.</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="in"># Load training data from Kaggle</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_data &lt;- read_csv("pulsar_data_train.csv")</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a><span class="in"># Update column names to be more 'code-friendly'</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(pulsar_data) &lt;- c("mean_integrated", "stdev_integrated", "kurtosis_integrated", "skew_integrated", "mean_DMSNR", "stdev_DMSNR", "kurtosis_DMSNR", "skew_DMSNR", "class")</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="in"># Covert target class to factor</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_data &lt;- pulsar_data %&gt;% mutate(class=as_factor(class))</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="in"># Load testing file from Kaggle</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_test_unclass &lt;- read_csv("pulsar_data_test.csv")</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a><span class="in">#Update column names to be more 'code friendly'</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(pulsar_test_unclass) &lt;- c("mean_integrated", "stdev_integrated", "kurtosis_integrated", "skew_integrated", "mean_DMSNR", "stdev_DMSNR", "kurtosis_DMSNR", "skew_DMSNR", "class")</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="in">summary(pulsar_test_unclass)</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>We can see that the test dataset doesn't have any target classes. So, this dataset is not useful to us in training/testing our model, and we will need to split the training dataset.</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>We will split the pulsar data set into training and testing sets. The testing set will not be touched until the model is ready for evaluation. We are splitting the data into 75% training and 25% testing because the dataset is sufficiently large (\~9,000 observations) that leaving 25% of the data for testing is enough to accurately assess the performance of our model.</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a><span class="in"># Split into training and testing set</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(111)</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a><span class="in"># Determine how many rows have missing values.</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a><span class="in">num_rows_missing_values &lt;- sum(apply(pulsar_data, 1, anyNA))</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a><span class="in"># Number of rows with missing values: 3183</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a><span class="in"># For our predictions down the road, we need to remove rows with NA values from the test set</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_omit_na &lt;- na.omit(pulsar_data) #this is so our KNN model will run properly later</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_split &lt;- initial_split(pulsar_omit_na, prop = 0.75, strata = class)</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_train &lt;- training(pulsar_split)</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_test &lt;- testing(pulsar_split)</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploratory Analysis</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a><span class="in">kable(head(pulsar_train))</span></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>There are eight predictive variables and one target variable. The predictors are composed of two groups of readings: the integrated profile and the DMSNR profile. Each group has the same four measurements: mean, standard deviation, kurtosis, and skew. We will use descriptive statistics and visualizations to explore the differences between the two profiles in order to determine which predictors will be most useful for our model.</span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate the number and percentage of observations that are pulsar stars.</span></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a><span class="in">num_obs &lt;- nrow(pulsar_train)</span></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a><span class="in">class_dist &lt;- pulsar_train %&gt;% group_by(class) %&gt;% summarize(n=n(), percentage=n()/num_obs*100)</span></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a><span class="in">class_dist</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a><span class="in">#class 0 (non-pulsar stars): 90.8% of the data</span></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a><span class="in">#class 1 (pulsar stars): 9.2% of the data</span></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a><span class="in"># We will also calculate the mean of the predictors in the dataset.</span></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a><span class="in">#mean of the predictors</span></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a><span class="in">predictor_means &lt;- pulsar_train %&gt;% select(-class) %&gt;% map_df(~mean(., na.rm=TRUE))</span></span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a><span class="in">predictor_means</span></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a><span class="in">#now, let's omit rows with NA values.</span></span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_train &lt;- na.omit(pulsar_train)</span></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>The predictors' scale varies significantly, as evidenced by the calculated means. Since the k-nn classification algorithm is particularly sensitive to predictors with larger values, we need to scale and center the data before building the model. This ensures that predictors with larger values (e.g. mean of the integrated profile) don't have a disproportionate effect on the classification model.</span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Visualization</span></span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>Visualizing the data can give us an idea of the distribution of predictors, and may give us an indication of which predictors will be most useful in the creation of our model.</span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE, fig.dim = c(20, 15)}</span></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a><span class="in">data_long &lt;- pulsar_train %&gt;%</span></span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a><span class="in">pivot_longer(cols = -c(class, mean_integrated, stdev_integrated, kurtosis_integrated, skew_integrated), names_to = "Variable", values_to = "Value")</span></span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a><span class="in">data_long$Variable &lt;- str_replace(data_long$Variable, "_DMSNR", "")</span></span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a><span class="in">options(repr.plot.width = 15, repr.plot.height = 10)</span></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a><span class="in">intdensity_plot &lt;- ggplot(data_long, aes(x = Value, fill = Variable)) +</span></span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(alpha = 0.7) +</span></span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ Variable, scales = "free", nrow = 2, ncol = 2) +</span></span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle("DMSNR") +</span></span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text = element_text(size = 15),</span></span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a><span class="in">       axis.title.x = element_text(hjust = 1)) +</span></span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("#e64186", "#672e8c", "#2d3569", "#c68dd8"))</span></span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a><span class="in">                                                        </span></span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a><span class="in">data_long1 &lt;- pulsar_train %&gt;%</span></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = -c(class, mean_DMSNR, stdev_DMSNR, kurtosis_DMSNR, skew_DMSNR), names_to = "Variable", values_to = "Value")</span></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a><span class="in">data_long1$Variable &lt;- str_replace(data_long1$Variable, "_integrated", "")</span></span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNRdensity_plot &lt;- ggplot(data_long1, aes(x = Value, fill = Variable)) +</span></span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(alpha = 0.7) +</span></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ Variable, scales = "free", nrow = 2, ncol = 2) +</span></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle("Integrated") +</span></span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text = element_text(size = 15)) +</span></span>
<span id="cb39-147"><a href="#cb39-147" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("") +</span></span>
<span id="cb39-148"><a href="#cb39-148" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("") +</span></span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("#e64186", "#672e8c", "#2d3569", "#c68dd8"), labels = c("Kurtosis", "Mean", "Skewness", "Standard Deviation"))</span></span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a><span class="in">combine_plot &lt;- plot_grid(intdensity_plot, DMSNRdensity_plot, nrow = 1, ncol = 2)</span></span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a><span class="in">plot_grid(ggdraw() + draw_label("Density plots", fontface='bold', size = 25), combine_plot, ncol=1, rel_heights=c(0.1, 1))</span></span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a>These distributions provide insights into the characteristics of the data for each variable, including the presence of outliers, the symmetry of the data, and the concentration of values. The skewness and kurtosis specifically provide information about the shape of the distribution, which can be useful in understanding the underlying patterns in the data.</span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE, fig.dim = c(20, 15)}</span></span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a><span class="in"># To visualize the distribution of pulsar vs non-pulsar stars, we can use a bar chart.</span></span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a><span class="in">class_plot &lt;- subset(class_dist, !is.na(class)) %&gt;% ggplot(aes(x=class, y=n, fill=class)) +</span></span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity") +</span></span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("Count") +</span></span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Class")+</span></span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title="Frequencies of target classes") +</span></span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()+</span></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text=element_text(size=20)) +</span></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Purples", labels = c("0" = "non-pulsar", "1" = "pulsar"))</span></span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a><span class="in">class_plot</span></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a>There are significantly more observations in the non-pulsar (0) than pulsar (1) class. Imbalanced data can result in the model inappropriately preferring the more common class. In order to account for this imbalance, we will need to upsample the pulsar class to produce an accurate model (see methods for more details on how this is done).</span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a>To visualize the relationship between predictors and the target class, we can create violin plots of each predictor variable stratified by target class. Unlike boxplots, violin plots allow us to visualize both the distribution and density of the underlying data. This additional detail about the data will help with our intuition when it comes to selecting predictors for our model.</span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a>Using those plots, we can see which predictors vary most between the two target classes, and between integrated and DM-SNR.</span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a>The data needs to be tidied before the violin plots can be created. Specifically, we will be moving the values of each of the predictors from their own columns into key-value pairs using the gather function.</span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_stars &lt;- pulsar_train %&gt;%</span></span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a><span class="in">gather(key=profile, value=value, mean_integrated, stdev_integrated, kurtosis_integrated, skew_integrated,</span></span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a><span class="in">mean_DMSNR, stdev_DMSNR, kurtosis_DMSNR, skew_DMSNR)</span></span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a><span class="in">kable(head(tidy_stars))</span></span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE, fig.dim = c(15, 10)}</span></span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a><span class="in">  # make violin plots comparing DM-SNR Curve and Integrated Profile variables, to see how they differ</span></span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a><span class="in">  # between our target classes</span></span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a><span class="in">  # tidy the data to generate a profile column</span></span>
<span id="cb39-192"><a href="#cb39-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-193"><a href="#cb39-193" aria-hidden="true" tabindex="-1"></a><span class="in"># mean violin</span></span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a><span class="in">mean_violin &lt;-  tidy_stars %&gt;%</span></span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(profile=="mean_integrated"|profile=="mean_DMSNR")%&gt;%</span></span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=profile, y=value), trim=TRUE)+</span></span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(aes(fill=class), draw_quantiles=c(0.5), colour = "red")+</span></span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Target class") +</span></span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("Mean Value")+</span></span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(fill="Class", title="Mean")+</span></span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text=element_text(size=20)) +</span></span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Reds", labels = c("0" = "non-pulsar", "1" = "pulsar"))</span></span>
<span id="cb39-204"><a href="#cb39-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-205"><a href="#cb39-205" aria-hidden="true" tabindex="-1"></a><span class="in"># sd violin</span></span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a><span class="in">  sd_violin &lt;-  tidy_stars %&gt;%</span></span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(profile=="stdev_integrated"|profile=="stdev_DMSNR")%&gt;%</span></span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=profile, y=value), trim=TRUE)+</span></span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(aes(fill=class), draw_quantiles=c(0.5), colour = "purple")+</span></span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Profile") +</span></span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("SD Value")+</span></span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(fill="Class", title="Standard Deviation")+</span></span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text=element_text(size=20)) +</span></span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "PuRd", labels = c("0" = "non-pulsar", "1" = "pulsar"))</span></span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a><span class="in"># kurtosis violin</span></span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a><span class="in">kurtosis_violin &lt;-  tidy_stars %&gt;%</span></span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(profile=="kurtosis_integrated"|profile=="kurtosis_DMSNR")%&gt;%</span></span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x=profile, y=value))+</span></span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(aes(fill=class), draw_quantiles=c(0.5), colour = "blue")+</span></span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Profile") +</span></span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("Kurtosis Value")+</span></span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(fill="Class", title="Kurtosis")+</span></span>
<span id="cb39-225"><a href="#cb39-225" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb39-226"><a href="#cb39-226" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text=element_text(size=20)) +</span></span>
<span id="cb39-227"><a href="#cb39-227" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Blues", labels = c("0" = "non-pulsar", "1" = "pulsar"))</span></span>
<span id="cb39-228"><a href="#cb39-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-229"><a href="#cb39-229" aria-hidden="true" tabindex="-1"></a><span class="in"># skew_violin</span></span>
<span id="cb39-230"><a href="#cb39-230" aria-hidden="true" tabindex="-1"></a><span class="in">skew_violin &lt;-  tidy_stars %&gt;%</span></span>
<span id="cb39-231"><a href="#cb39-231" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(profile=="skew_integrated"|profile=="skew_DMSNR")%&gt;%</span></span>
<span id="cb39-232"><a href="#cb39-232" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=profile, y=value), draw_quantiles=c(0.5))+</span></span>
<span id="cb39-233"><a href="#cb39-233" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(aes(fill=class), colour = "darkgreen")+</span></span>
<span id="cb39-234"><a href="#cb39-234" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Profile") +</span></span>
<span id="cb39-235"><a href="#cb39-235" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("Skew Value")+</span></span>
<span id="cb39-236"><a href="#cb39-236" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(fill="Class", title="Skew")+</span></span>
<span id="cb39-237"><a href="#cb39-237" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb39-238"><a href="#cb39-238" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(text=element_text(size=20)) +</span></span>
<span id="cb39-239"><a href="#cb39-239" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Greens", labels = c("0" = "non-pulsar", "1" = "pulsar"))</span></span>
<span id="cb39-240"><a href="#cb39-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-241"><a href="#cb39-241" aria-hidden="true" tabindex="-1"></a><span class="in">combined_plot &lt;- plot_grid(mean_violin, sd_violin, kurtosis_violin, skew_violin, nrow = 2, ncol = 2)</span></span>
<span id="cb39-242"><a href="#cb39-242" aria-hidden="true" tabindex="-1"></a><span class="in">plot_grid(ggdraw() + draw_label("Class Across Key Factors", fontface='bold', size = 25), combined_plot, ncol=1, rel_heights=c(0.1, 1))</span></span>
<span id="cb39-243"><a href="#cb39-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-244"><a href="#cb39-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-245"><a href="#cb39-245" aria-hidden="true" tabindex="-1"></a>Figures 2-5 are violin plots of the four types of measurements that were collected (mean, standard deviation, kurtosis, and skew), stratified by target class and profile (integrated vs DMSNR). These plots allow us to determine which predictors will be most useful for building our classification model.</span>
<span id="cb39-246"><a href="#cb39-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-247"><a href="#cb39-247" aria-hidden="true" tabindex="-1"></a>Firstly, it demonstrates how the predictors vary between the two target classes. A predictor whose distribution varies significantly between the target classes (for example, in Figure 3), is likely to be more useful for our classification model than a predictor with very similar distributions.</span>
<span id="cb39-248"><a href="#cb39-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-249"><a href="#cb39-249" aria-hidden="true" tabindex="-1"></a>Secondly, these plots demonstrate the difference between the integrated and DMSNR profiles. We can see which profile varies more between the two target classes, thus allowing us to predict which profile will be more useful for building classification models.</span>
<span id="cb39-250"><a href="#cb39-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-251"><a href="#cb39-251" aria-hidden="true" tabindex="-1"></a>We can see that while each predictor is extremely different depending on whether it is from the integrated or DM-SNR profile, all groups show a difference in the distribution and mean of the target classes within the same variable. So, each would be a useful addition to their respective models. As well, from a broader perspective, we want to use all of the scientific data available to us, since it was painstakingly collected and cleaned, and omission of a particular variable without reasonable grounds could cause us to lose accuracy in our models.</span>
<span id="cb39-252"><a href="#cb39-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-253"><a href="#cb39-253" aria-hidden="true" tabindex="-1"></a><span class="fu">### K-Nearest Neighbors Analysis</span></span>
<span id="cb39-254"><a href="#cb39-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-255"><a href="#cb39-255" aria-hidden="true" tabindex="-1"></a>After our preliminary analysis, our next step will be to use our integrated and DM-SNR variables to predict pulsar stars using the K-Nearest Neighbors classification algorithm.</span>
<span id="cb39-256"><a href="#cb39-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-257"><a href="#cb39-257" aria-hidden="true" tabindex="-1"></a>This will help us determine whether one of these two recording techniques is better than the other at distinguishing pulsar stars from the noise of space.</span>
<span id="cb39-258"><a href="#cb39-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-259"><a href="#cb39-259" aria-hidden="true" tabindex="-1"></a>Our first step is to set up our KNN model, using the integrated variables. We will do this in several steps. 1. Make a recipe. The recipe will preprocess our data by centering and scaling our predictors (since the ranges of our predictors differ), and upsample our target class (since it is \~90% target class 0). 2. Make a KNN spec, to tell the computer to run KNN (and with what parameters). This will include the neighbors=tune() function so we can find the value of K that gives us the highest accuracy. 3. Make our cross validation sets, so we can test our tuning model and find accuracies of different K's. 4. Make a tuning workflow, to tune the KNN model and find the value of K giving the highest accuracy.</span>
<span id="cb39-260"><a href="#cb39-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-261"><a href="#cb39-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-262"><a href="#cb39-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-263"><a href="#cb39-263" aria-hidden="true" tabindex="-1"></a><span class="in">#1. First, we make our recipe, which will preprocess our data.</span></span>
<span id="cb39-264"><a href="#cb39-264" aria-hidden="true" tabindex="-1"></a><span class="in">recipe_integrated &lt;- recipe(class ~ mean_integrated + stdev_integrated + kurtosis_integrated +</span></span>
<span id="cb39-265"><a href="#cb39-265" aria-hidden="true" tabindex="-1"></a><span class="in">skew_integrated, data = pulsar_train) %&gt;%</span></span>
<span id="cb39-266"><a href="#cb39-266" aria-hidden="true" tabindex="-1"></a><span class="in">    step_scale(all_predictors()) %&gt;%</span></span>
<span id="cb39-267"><a href="#cb39-267" aria-hidden="true" tabindex="-1"></a><span class="in">    step_center(all_predictors())%&gt;%</span></span>
<span id="cb39-268"><a href="#cb39-268" aria-hidden="true" tabindex="-1"></a><span class="in">    step_upsample(class, over_ratio=1, skip=TRUE)</span></span>
<span id="cb39-269"><a href="#cb39-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-270"><a href="#cb39-270" aria-hidden="true" tabindex="-1"></a><span class="in">recipe_integrated</span></span>
<span id="cb39-271"><a href="#cb39-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-272"><a href="#cb39-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-273"><a href="#cb39-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-274"><a href="#cb39-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-275"><a href="#cb39-275" aria-hidden="true" tabindex="-1"></a><span class="in">#2. Next, we will create our model, so the computer knows how to run the KNN</span></span>
<span id="cb39-276"><a href="#cb39-276" aria-hidden="true" tabindex="-1"></a><span class="in">knn_tune &lt;- nearest_neighbor(weight_func = "rectangular", neighbors = tune()) %&gt;%</span></span>
<span id="cb39-277"><a href="#cb39-277" aria-hidden="true" tabindex="-1"></a><span class="in">            set_engine("kknn") %&gt;%</span></span>
<span id="cb39-278"><a href="#cb39-278" aria-hidden="true" tabindex="-1"></a><span class="in">            set_mode("classification")</span></span>
<span id="cb39-279"><a href="#cb39-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-280"><a href="#cb39-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-281"><a href="#cb39-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-282"><a href="#cb39-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-283"><a href="#cb39-283" aria-hidden="true" tabindex="-1"></a><span class="in">#3. next, we make our cross-validation set to test iterations of K</span></span>
<span id="cb39-284"><a href="#cb39-284" aria-hidden="true" tabindex="-1"></a><span class="in">vfold &lt;- vfold_cv(pulsar_train, v = 5, strata = class)</span></span>
<span id="cb39-285"><a href="#cb39-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-286"><a href="#cb39-286" aria-hidden="true" tabindex="-1"></a><span class="in">#4. now, we make a workflow to find the best value of K, to give our training model the best accuracy.</span></span>
<span id="cb39-287"><a href="#cb39-287" aria-hidden="true" tabindex="-1"></a><span class="in">knn_fit &lt;- workflow() %&gt;%</span></span>
<span id="cb39-288"><a href="#cb39-288" aria-hidden="true" tabindex="-1"></a><span class="in">        add_recipe(recipe_integrated) %&gt;%</span></span>
<span id="cb39-289"><a href="#cb39-289" aria-hidden="true" tabindex="-1"></a><span class="in">        add_model(knn_tune) %&gt;%</span></span>
<span id="cb39-290"><a href="#cb39-290" aria-hidden="true" tabindex="-1"></a><span class="in">        tune_grid(resamples = vfold, grid = 20) %&gt;%</span></span>
<span id="cb39-291"><a href="#cb39-291" aria-hidden="true" tabindex="-1"></a><span class="in">        collect_metrics()</span></span>
<span id="cb39-292"><a href="#cb39-292" aria-hidden="true" tabindex="-1"></a><span class="in">        #note: grid=20 to test 20 values of K, rather than the usual 10</span></span>
<span id="cb39-293"><a href="#cb39-293" aria-hidden="true" tabindex="-1"></a><span class="in">        #This is so we can confidently find the value of K with the highest accuracy by being more rigorous with our testing</span></span>
<span id="cb39-294"><a href="#cb39-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-295"><a href="#cb39-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-296"><a href="#cb39-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-297"><a href="#cb39-297" aria-hidden="true" tabindex="-1"></a>Now that our model has been tuned, we can pull the accuracy of our tuning model for each iteration of K, and plot it to show how accuracy changes depending on K.</span>
<span id="cb39-298"><a href="#cb39-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-299"><a href="#cb39-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-300"><a href="#cb39-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-301"><a href="#cb39-301" aria-hidden="true" tabindex="-1"></a><span class="in">#pull accuracies</span></span>
<span id="cb39-302"><a href="#cb39-302" aria-hidden="true" tabindex="-1"></a><span class="in">accuracies &lt;- knn_fit %&gt;%</span></span>
<span id="cb39-303"><a href="#cb39-303" aria-hidden="true" tabindex="-1"></a><span class="in">       filter(.metric == "accuracy")</span></span>
<span id="cb39-304"><a href="#cb39-304" aria-hidden="true" tabindex="-1"></a><span class="in">#plot accuracy against K</span></span>
<span id="cb39-305"><a href="#cb39-305" aria-hidden="true" tabindex="-1"></a><span class="in">cross_val_plot &lt;- ggplot(accuracies, aes(x = neighbors , y = mean)) +</span></span>
<span id="cb39-306"><a href="#cb39-306" aria-hidden="true" tabindex="-1"></a><span class="in">       geom_point() +</span></span>
<span id="cb39-307"><a href="#cb39-307" aria-hidden="true" tabindex="-1"></a><span class="in">       geom_line() +</span></span>
<span id="cb39-308"><a href="#cb39-308" aria-hidden="true" tabindex="-1"></a><span class="in">       labs(x = "Neighbours", y = "Accuracy Estimate", title = "Integrated profile model accuracy")  +</span></span>
<span id="cb39-309"><a href="#cb39-309" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(text = element_text(size = 20))</span></span>
<span id="cb39-310"><a href="#cb39-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-311"><a href="#cb39-311" aria-hidden="true" tabindex="-1"></a><span class="in">cross_val_plot</span></span>
<span id="cb39-312"><a href="#cb39-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-313"><a href="#cb39-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-314"><a href="#cb39-314" aria-hidden="true" tabindex="-1"></a>According to the plot above, the value of K that gives the highest accuracy is K=2. We will now make another model that uses this value of K to predict the class of a testing set. This will require us to make a new KNN spec and workflow- but we can reuse our old recipe, since it isn't affected by choosing K.</span>
<span id="cb39-315"><a href="#cb39-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-316"><a href="#cb39-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-317"><a href="#cb39-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-318"><a href="#cb39-318" aria-hidden="true" tabindex="-1"></a><span class="in">#pull the value of K giving the highest accuracy (2)</span></span>
<span id="cb39-319"><a href="#cb39-319" aria-hidden="true" tabindex="-1"></a><span class="in">kn_integrated &lt;- knn_fit %&gt;%</span></span>
<span id="cb39-320"><a href="#cb39-320" aria-hidden="true" tabindex="-1"></a><span class="in">       filter(.metric == "accuracy") %&gt;%</span></span>
<span id="cb39-321"><a href="#cb39-321" aria-hidden="true" tabindex="-1"></a><span class="in">       arrange(desc(mean)) %&gt;%</span></span>
<span id="cb39-322"><a href="#cb39-322" aria-hidden="true" tabindex="-1"></a><span class="in">       head(1) %&gt;%</span></span>
<span id="cb39-323"><a href="#cb39-323" aria-hidden="true" tabindex="-1"></a><span class="in">       pull(neighbors)</span></span>
<span id="cb39-324"><a href="#cb39-324" aria-hidden="true" tabindex="-1"></a><span class="in">kn_integrated</span></span>
<span id="cb39-325"><a href="#cb39-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-326"><a href="#cb39-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-327"><a href="#cb39-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-328"><a href="#cb39-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-329"><a href="#cb39-329" aria-hidden="true" tabindex="-1"></a><span class="in">#make another KNN spec, this time with neighbors= our chosen value of K</span></span>
<span id="cb39-330"><a href="#cb39-330" aria-hidden="true" tabindex="-1"></a><span class="in">int_spec &lt;- nearest_neighbor(weight_func = "rectangular", neighbors = kn_integrated) %&gt;%</span></span>
<span id="cb39-331"><a href="#cb39-331" aria-hidden="true" tabindex="-1"></a><span class="in">              set_engine("kknn") %&gt;%</span></span>
<span id="cb39-332"><a href="#cb39-332" aria-hidden="true" tabindex="-1"></a><span class="in">              set_mode("classification")</span></span>
<span id="cb39-333"><a href="#cb39-333" aria-hidden="true" tabindex="-1"></a><span class="in">#make the workflow to build our final model</span></span>
<span id="cb39-334"><a href="#cb39-334" aria-hidden="true" tabindex="-1"></a><span class="in">int_fit &lt;- workflow() %&gt;%</span></span>
<span id="cb39-335"><a href="#cb39-335" aria-hidden="true" tabindex="-1"></a><span class="in">             add_recipe(recipe_integrated) %&gt;%</span></span>
<span id="cb39-336"><a href="#cb39-336" aria-hidden="true" tabindex="-1"></a><span class="in">             add_model(int_spec) %&gt;%</span></span>
<span id="cb39-337"><a href="#cb39-337" aria-hidden="true" tabindex="-1"></a><span class="in">             fit(data = pulsar_train)</span></span>
<span id="cb39-338"><a href="#cb39-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-339"><a href="#cb39-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-340"><a href="#cb39-340" aria-hidden="true" tabindex="-1"></a>Now that we've build our final model, we can test it using data it hasn't seen before, i.e. our testing set. This will tell us its overall accuracy in predicting the class of an unknown star, and how good it is at predicting pulsar stars specifically. Once we have predicted the testing set, we can gather its metrics to see its accuracy, and plot it as a confusion matrix to see how many times it predicted each class correctly, and incorrectly.</span>
<span id="cb39-341"><a href="#cb39-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-342"><a href="#cb39-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-343"><a href="#cb39-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-344"><a href="#cb39-344" aria-hidden="true" tabindex="-1"></a><span class="in">#predict the testing set using our integrated model</span></span>
<span id="cb39-345"><a href="#cb39-345" aria-hidden="true" tabindex="-1"></a><span class="in">int_pred &lt;- predict(int_fit, pulsar_test) %&gt;% bind_cols(pulsar_test)</span></span>
<span id="cb39-346"><a href="#cb39-346" aria-hidden="true" tabindex="-1"></a><span class="in">#get the accuracy of our model at predicting the test class</span></span>
<span id="cb39-347"><a href="#cb39-347" aria-hidden="true" tabindex="-1"></a><span class="in">int_metrics &lt;- int_pred %&gt;% metrics(truth = class, estimate=.pred_class)</span></span>
<span id="cb39-348"><a href="#cb39-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-349"><a href="#cb39-349" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate confusion matrix</span></span>
<span id="cb39-350"><a href="#cb39-350" aria-hidden="true" tabindex="-1"></a><span class="in">int_mat &lt;- int_pred %&gt;%</span></span>
<span id="cb39-351"><a href="#cb39-351" aria-hidden="true" tabindex="-1"></a><span class="in">  conf_mat(truth = class, estimate = .pred_class)</span></span>
<span id="cb39-352"><a href="#cb39-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-353"><a href="#cb39-353" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert confusion matrix to data frame</span></span>
<span id="cb39-354"><a href="#cb39-354" aria-hidden="true" tabindex="-1"></a><span class="in">int_mat_df &lt;- as.data.frame(int_mat$table)</span></span>
<span id="cb39-355"><a href="#cb39-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-356"><a href="#cb39-356" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot the confusion matrix using ggplot2</span></span>
<span id="cb39-357"><a href="#cb39-357" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(int_mat_df, aes(x = Truth, y = Prediction, fill = factor(Freq))) +</span></span>
<span id="cb39-358"><a href="#cb39-358" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_tile(color = "white") +</span></span>
<span id="cb39-359"><a href="#cb39-359" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(aes(label = Freq), vjust = 1) +</span></span>
<span id="cb39-360"><a href="#cb39-360" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Confusion Matrix",</span></span>
<span id="cb39-361"><a href="#cb39-361" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Predicted Class",</span></span>
<span id="cb39-362"><a href="#cb39-362" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "True Class",</span></span>
<span id="cb39-363"><a href="#cb39-363" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Frequency") +</span></span>
<span id="cb39-364"><a href="#cb39-364" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-365"><a href="#cb39-365" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb39-366"><a href="#cb39-366" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Blues")</span></span>
<span id="cb39-367"><a href="#cb39-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-368"><a href="#cb39-368" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_int_mat &lt;- tidy(int_mat) #this is for later</span></span>
<span id="cb39-369"><a href="#cb39-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-370"><a href="#cb39-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-371"><a href="#cb39-371" aria-hidden="true" tabindex="-1"></a>We are finished with our integrated model, and can begin making our DM-SNR model. This will follow the same steps as above. Firstly, we will set up a recipe to tune the value of K to that which gives the highest accuracy of our training model. To do this, we will: 1. Make a new recipe. 2. Reuse our old KNN spec (since it doesn't depend on our variables) 3. Reuse our old cross validation sets (since they don't depend on our variables) 4. Make a tuning workflow, to find the best value of K.</span>
<span id="cb39-372"><a href="#cb39-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-373"><a href="#cb39-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-374"><a href="#cb39-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-375"><a href="#cb39-375" aria-hidden="true" tabindex="-1"></a><span class="in">#make the recipe</span></span>
<span id="cb39-376"><a href="#cb39-376" aria-hidden="true" tabindex="-1"></a><span class="in">recipe_DMSNR &lt;- recipe(class ~ mean_DMSNR + stdev_DMSNR + kurtosis_DMSNR +</span></span>
<span id="cb39-377"><a href="#cb39-377" aria-hidden="true" tabindex="-1"></a><span class="in">skew_DMSNR, data = pulsar_train) %&gt;%</span></span>
<span id="cb39-378"><a href="#cb39-378" aria-hidden="true" tabindex="-1"></a><span class="in">    step_scale(all_predictors()) %&gt;%</span></span>
<span id="cb39-379"><a href="#cb39-379" aria-hidden="true" tabindex="-1"></a><span class="in">    step_center(all_predictors())%&gt;%</span></span>
<span id="cb39-380"><a href="#cb39-380" aria-hidden="true" tabindex="-1"></a><span class="in">    step_upsample(class, over_ratio=1, skip=TRUE)</span></span>
<span id="cb39-381"><a href="#cb39-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-382"><a href="#cb39-382" aria-hidden="true" tabindex="-1"></a><span class="in">#reuse KNN spec and cross validation sets</span></span>
<span id="cb39-383"><a href="#cb39-383" aria-hidden="true" tabindex="-1"></a><span class="in">#make our tuning workflow</span></span>
<span id="cb39-384"><a href="#cb39-384" aria-hidden="true" tabindex="-1"></a><span class="in">knn_fit &lt;- workflow() %&gt;%</span></span>
<span id="cb39-385"><a href="#cb39-385" aria-hidden="true" tabindex="-1"></a><span class="in">        add_recipe(recipe_DMSNR) %&gt;%</span></span>
<span id="cb39-386"><a href="#cb39-386" aria-hidden="true" tabindex="-1"></a><span class="in">        add_model(knn_tune) %&gt;%</span></span>
<span id="cb39-387"><a href="#cb39-387" aria-hidden="true" tabindex="-1"></a><span class="in">        tune_grid(resamples = vfold, grid = 20) %&gt;% #note: grid=20 to test 20 values of K, rather than the usual 10</span></span>
<span id="cb39-388"><a href="#cb39-388" aria-hidden="true" tabindex="-1"></a><span class="in">        collect_metrics()</span></span>
<span id="cb39-389"><a href="#cb39-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-390"><a href="#cb39-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-391"><a href="#cb39-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-392"><a href="#cb39-392" aria-hidden="true" tabindex="-1"></a>With our DM-SNR tuning workflow, we can pull the accuracies of each K in our tuning model, and plot them to see how accuracy depends on K.</span>
<span id="cb39-393"><a href="#cb39-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-394"><a href="#cb39-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-395"><a href="#cb39-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-396"><a href="#cb39-396" aria-hidden="true" tabindex="-1"></a><span class="in">#pull accuracies</span></span>
<span id="cb39-397"><a href="#cb39-397" aria-hidden="true" tabindex="-1"></a><span class="in">accuracies &lt;- knn_fit %&gt;%</span></span>
<span id="cb39-398"><a href="#cb39-398" aria-hidden="true" tabindex="-1"></a><span class="in">       filter(.metric == "accuracy")</span></span>
<span id="cb39-399"><a href="#cb39-399" aria-hidden="true" tabindex="-1"></a><span class="in">#make the plot</span></span>
<span id="cb39-400"><a href="#cb39-400" aria-hidden="true" tabindex="-1"></a><span class="in">cross_val_plot &lt;- ggplot(accuracies, aes(x = neighbors , y = mean)) +</span></span>
<span id="cb39-401"><a href="#cb39-401" aria-hidden="true" tabindex="-1"></a><span class="in">       geom_point() +</span></span>
<span id="cb39-402"><a href="#cb39-402" aria-hidden="true" tabindex="-1"></a><span class="in">       geom_line() +</span></span>
<span id="cb39-403"><a href="#cb39-403" aria-hidden="true" tabindex="-1"></a><span class="in">       labs(x = "Neighbours", y = "Accuracy Estimate", title = "DM-SNR profile model accuracy")  +</span></span>
<span id="cb39-404"><a href="#cb39-404" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(text = element_text(size = 20))</span></span>
<span id="cb39-405"><a href="#cb39-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-406"><a href="#cb39-406" aria-hidden="true" tabindex="-1"></a><span class="in">cross_val_plot</span></span>
<span id="cb39-407"><a href="#cb39-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-408"><a href="#cb39-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-409"><a href="#cb39-409" aria-hidden="true" tabindex="-1"></a>The plot tells that the value of K giving the highest accuracy of our training model is K=1. We will pull that value, and use it to build a new model to predict our testing set (and other unknown stars). We can reuse our old recipe and build a new KNN spec for our best value of K (value of K giving the highest accuracy), and a new workflow for our final DM-SNR model.</span>
<span id="cb39-410"><a href="#cb39-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-411"><a href="#cb39-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-412"><a href="#cb39-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-413"><a href="#cb39-413" aria-hidden="true" tabindex="-1"></a><span class="in">kn_DMSNR &lt;- knn_fit %&gt;%</span></span>
<span id="cb39-414"><a href="#cb39-414" aria-hidden="true" tabindex="-1"></a><span class="in">       filter(.metric == "accuracy") %&gt;%</span></span>
<span id="cb39-415"><a href="#cb39-415" aria-hidden="true" tabindex="-1"></a><span class="in">       arrange(desc(mean)) %&gt;%</span></span>
<span id="cb39-416"><a href="#cb39-416" aria-hidden="true" tabindex="-1"></a><span class="in">       head(1) %&gt;%</span></span>
<span id="cb39-417"><a href="#cb39-417" aria-hidden="true" tabindex="-1"></a><span class="in">       pull(neighbors)</span></span>
<span id="cb39-418"><a href="#cb39-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-419"><a href="#cb39-419" aria-hidden="true" tabindex="-1"></a><span class="in">#make new KNN spec with best value of K</span></span>
<span id="cb39-420"><a href="#cb39-420" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_int_spec &lt;- nearest_neighbor(weight_func = "rectangular", neighbors = kn_DMSNR) %&gt;%</span></span>
<span id="cb39-421"><a href="#cb39-421" aria-hidden="true" tabindex="-1"></a><span class="in">              set_engine("kknn") %&gt;%</span></span>
<span id="cb39-422"><a href="#cb39-422" aria-hidden="true" tabindex="-1"></a><span class="in">              set_mode("classification")</span></span>
<span id="cb39-423"><a href="#cb39-423" aria-hidden="true" tabindex="-1"></a><span class="in">#make final workflow</span></span>
<span id="cb39-424"><a href="#cb39-424" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_int_fit &lt;- workflow() %&gt;%</span></span>
<span id="cb39-425"><a href="#cb39-425" aria-hidden="true" tabindex="-1"></a><span class="in">             add_recipe(recipe_DMSNR) %&gt;%</span></span>
<span id="cb39-426"><a href="#cb39-426" aria-hidden="true" tabindex="-1"></a><span class="in">             add_model(DMSNR_int_spec) %&gt;%</span></span>
<span id="cb39-427"><a href="#cb39-427" aria-hidden="true" tabindex="-1"></a><span class="in">             fit(data = pulsar_train)</span></span>
<span id="cb39-428"><a href="#cb39-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-429"><a href="#cb39-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-430"><a href="#cb39-430" aria-hidden="true" tabindex="-1"></a>Now that our final DM-SNR model is built, we will test it on data it hasn't seen before (the testing set) to find its accuracy. We can pull the overall accuracy of the model using the metrics() function, and use a confusion matrix to show how many times our model correctly and incorrectly identified the class of the stars by comparing their true and predicted class.</span>
<span id="cb39-431"><a href="#cb39-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-432"><a href="#cb39-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-433"><a href="#cb39-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-434"><a href="#cb39-434" aria-hidden="true" tabindex="-1"></a><span class="in">#Predict the testing data</span></span>
<span id="cb39-435"><a href="#cb39-435" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_int_pred &lt;- predict(DMSNR_int_fit, pulsar_test) %&gt;%</span></span>
<span id="cb39-436"><a href="#cb39-436" aria-hidden="true" tabindex="-1"></a><span class="in">                    bind_cols(pulsar_test)</span></span>
<span id="cb39-437"><a href="#cb39-437" aria-hidden="true" tabindex="-1"></a><span class="in">#get the accuracy of our model at predicting the classes of the test data</span></span>
<span id="cb39-438"><a href="#cb39-438" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_int_metrics &lt;- DMSNR_int_pred %&gt;%</span></span>
<span id="cb39-439"><a href="#cb39-439" aria-hidden="true" tabindex="-1"></a><span class="in">metrics(truth = class, estimate=.pred_class)</span></span>
<span id="cb39-440"><a href="#cb39-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-441"><a href="#cb39-441" aria-hidden="true" tabindex="-1"></a><span class="in">#make a confusion matrix</span></span>
<span id="cb39-442"><a href="#cb39-442" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_mat &lt;- DMSNR_int_pred %&gt;%</span></span>
<span id="cb39-443"><a href="#cb39-443" aria-hidden="true" tabindex="-1"></a><span class="in">      conf_mat(truth = class, estimate = .pred_class)</span></span>
<span id="cb39-444"><a href="#cb39-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-445"><a href="#cb39-445" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert confusion matrix to data frame</span></span>
<span id="cb39-446"><a href="#cb39-446" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_mat_df &lt;- as.data.frame(DMSNR_mat$table)</span></span>
<span id="cb39-447"><a href="#cb39-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-448"><a href="#cb39-448" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot the confusion matrix using ggplot2</span></span>
<span id="cb39-449"><a href="#cb39-449" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(DMSNR_mat_df, aes(x = Truth, y = Prediction, fill = factor(Freq))) +</span></span>
<span id="cb39-450"><a href="#cb39-450" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_tile(color = "white") +</span></span>
<span id="cb39-451"><a href="#cb39-451" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(aes(label = Freq), vjust = 1) +</span></span>
<span id="cb39-452"><a href="#cb39-452" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Confusion Matrix",</span></span>
<span id="cb39-453"><a href="#cb39-453" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Predicted Class",</span></span>
<span id="cb39-454"><a href="#cb39-454" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "True Class",</span></span>
<span id="cb39-455"><a href="#cb39-455" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Frequency") +</span></span>
<span id="cb39-456"><a href="#cb39-456" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-457"><a href="#cb39-457" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb39-458"><a href="#cb39-458" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_brewer(palette = "Purples")</span></span>
<span id="cb39-459"><a href="#cb39-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-460"><a href="#cb39-460" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_DMSNR_mat &lt;- tidy(DMSNR_mat)#this is for later</span></span>
<span id="cb39-461"><a href="#cb39-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-462"><a href="#cb39-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-463"><a href="#cb39-463" aria-hidden="true" tabindex="-1"></a>Finally, to display our data we will make a grouped bar chart, showing both the overall accuracy and the accuracy of predicting pulsar stars (the true positive rate). It is important for us to look at overall accuracy and pulsar star classification accuracy because while we do want a model that has a high overall accuracy, our goal is to find the model that is the best at predicting pular stars (not just non-pulsars), so we need to compare both metrics of our models. We will also calculate a false positive rate, as the goal of our project is to correctly identify pulsar stars - so while a false negative (classifying a pulsar as a non-pulsar star) is not ideal, it is not as detrimental as false positives (classifying a non-pulsar as a pulsar) as this affects our ability to gain accurate knowledge on pulsar stars using our model.</span>
<span id="cb39-464"><a href="#cb39-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-465"><a href="#cb39-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE}</span></span>
<span id="cb39-466"><a href="#cb39-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-467"><a href="#cb39-467" aria-hidden="true" tabindex="-1"></a><span class="in">#gather the values from our accuracy estimates</span></span>
<span id="cb39-468"><a href="#cb39-468" aria-hidden="true" tabindex="-1"></a><span class="in">#gather overall accuracy estimates from our two models</span></span>
<span id="cb39-469"><a href="#cb39-469" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_accuracy &lt;- as.numeric(DMSNR_int_metrics[1, 3])*100 #92.3%</span></span>
<span id="cb39-470"><a href="#cb39-470" aria-hidden="true" tabindex="-1"></a><span class="in">integrated_accuracy &lt;- as.numeric(int_metrics[1, 3])*100 #96.8%</span></span>
<span id="cb39-471"><a href="#cb39-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-472"><a href="#cb39-472" aria-hidden="true" tabindex="-1"></a><span class="in">#gather accuracy estimates of pulsar stars only from our confusian matrices</span></span>
<span id="cb39-473"><a href="#cb39-473" aria-hidden="true" tabindex="-1"></a><span class="in">#this is correctly identified pulsars/ total number of true pulsars *100</span></span>
<span id="cb39-474"><a href="#cb39-474" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_integrated &lt;- as.numeric(tidy_int_mat[4,2])/</span></span>
<span id="cb39-475"><a href="#cb39-475" aria-hidden="true" tabindex="-1"></a><span class="in">(as.numeric(tidy_int_mat[3,2])+as.numeric(tidy_int_mat[4,2]))*100</span></span>
<span id="cb39-476"><a href="#cb39-476" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_integrated #77.5%</span></span>
<span id="cb39-477"><a href="#cb39-477" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_DMSNR &lt;- as.numeric(tidy_DMSNR_mat[4,2])/</span></span>
<span id="cb39-478"><a href="#cb39-478" aria-hidden="true" tabindex="-1"></a><span class="in">(as.numeric(tidy_DMSNR_mat[3,2])+as.numeric(tidy_DMSNR_mat[4,2]))*100</span></span>
<span id="cb39-479"><a href="#cb39-479" aria-hidden="true" tabindex="-1"></a><span class="in">pulsar_DMSNR #58.0%</span></span>
<span id="cb39-480"><a href="#cb39-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-481"><a href="#cb39-481" aria-hidden="true" tabindex="-1"></a><span class="in">#gather accuracy estimates of pulsar stars from confusion matrix</span></span>
<span id="cb39-482"><a href="#cb39-482" aria-hidden="true" tabindex="-1"></a><span class="in">#calculate false positive rate</span></span>
<span id="cb39-483"><a href="#cb39-483" aria-hidden="true" tabindex="-1"></a><span class="in">#this is false positive rate (0's classified as 1)/total negatives (all 0's) *100</span></span>
<span id="cb39-484"><a href="#cb39-484" aria-hidden="true" tabindex="-1"></a><span class="in">integrated_falsepos &lt;- as.numeric(tidy_int_mat[2, 2])/</span></span>
<span id="cb39-485"><a href="#cb39-485" aria-hidden="true" tabindex="-1"></a><span class="in">(as.numeric(tidy_int_mat[1, 2])+as.numeric(tidy_int_mat[2, 2]))*100</span></span>
<span id="cb39-486"><a href="#cb39-486" aria-hidden="true" tabindex="-1"></a><span class="in">integrated_falsepos #1.2%</span></span>
<span id="cb39-487"><a href="#cb39-487" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_falsepos &lt;- as.numeric(tidy_DMSNR_mat[2,2])/</span></span>
<span id="cb39-488"><a href="#cb39-488" aria-hidden="true" tabindex="-1"></a><span class="in">((as.numeric(tidy_DMSNR_mat[1,2])+as.numeric(tidy_DMSNR_mat[2,2])))*100</span></span>
<span id="cb39-489"><a href="#cb39-489" aria-hidden="true" tabindex="-1"></a><span class="in">DMSNR_falsepos #4.2%</span></span>
<span id="cb39-490"><a href="#cb39-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-491"><a href="#cb39-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-492"><a href="#cb39-492" aria-hidden="true" tabindex="-1"></a>Now we can plot our accuracy estimates as a grouped bar chart.</span>
<span id="cb39-493"><a href="#cb39-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-494"><a href="#cb39-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning = FALSE, fig.dim = c(15, 10)}</span></span>
<span id="cb39-495"><a href="#cb39-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-496"><a href="#cb39-496" aria-hidden="true" tabindex="-1"></a><span class="in">#make a new dataframe for our plot</span></span>
<span id="cb39-497"><a href="#cb39-497" aria-hidden="true" tabindex="-1"></a><span class="in">accuracies &lt;- data.frame("percent_accuracy"=c(DMSNR_accuracy, integrated_accuracy, pulsar_integrated, pulsar_DMSNR))</span></span>
<span id="cb39-498"><a href="#cb39-498" aria-hidden="true" tabindex="-1"></a><span class="in">names &lt;- data.frame("type"=c("DMSNR", "Integrated", "Integrated", "DMSNR"))</span></span>
<span id="cb39-499"><a href="#cb39-499" aria-hidden="true" tabindex="-1"></a><span class="in">subgroup &lt;- data.frame("subgroup"=c("Overall Accuracy", "Overall Accuracy", "Pulsar Identification Accuracy", "Pulsar Identification Accuracy"))</span></span>
<span id="cb39-500"><a href="#cb39-500" aria-hidden="true" tabindex="-1"></a><span class="in">accuracy_table &lt;- bind_cols(names, accuracies, subgroup)</span></span>
<span id="cb39-501"><a href="#cb39-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-502"><a href="#cb39-502" aria-hidden="true" tabindex="-1"></a><span class="in">#make the plot</span></span>
<span id="cb39-503"><a href="#cb39-503" aria-hidden="true" tabindex="-1"></a><span class="in">accuracy_plot &lt;- ggplot(accuracy_table, aes(x=type, y=percent_accuracy, fill=subgroup))+</span></span>
<span id="cb39-504"><a href="#cb39-504" aria-hidden="true" tabindex="-1"></a><span class="in">geom_bar(aes(fill=subgroup),stat="identity", position="dodge")+</span></span>
<span id="cb39-505"><a href="#cb39-505" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Type of Star Recording", y="Percent Accuracy of KNN Model", fill="Accuracy Type", title="Overall and true positive accuracy")+</span></span>
<span id="cb39-506"><a href="#cb39-506" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()+</span></span>
<span id="cb39-507"><a href="#cb39-507" aria-hidden="true" tabindex="-1"></a><span class="in">theme(text = element_text(size=20)) +</span></span>
<span id="cb39-508"><a href="#cb39-508" aria-hidden="true" tabindex="-1"></a><span class="in">scale_fill_brewer(palette = "BuGn")</span></span>
<span id="cb39-509"><a href="#cb39-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-510"><a href="#cb39-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-511"><a href="#cb39-511" aria-hidden="true" tabindex="-1"></a><span class="in">accuracy_plot</span></span>
<span id="cb39-512"><a href="#cb39-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-513"><a href="#cb39-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-514"><a href="#cb39-514" aria-hidden="true" tabindex="-1"></a>From this barchart, we observe that the overall accuracy and accuracy of pulsar star identification differs between our two models. In both, the integrated model shows higher accuracy.</span>
<span id="cb39-515"><a href="#cb39-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-516"><a href="#cb39-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb39-517"><a href="#cb39-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-518"><a href="#cb39-518" aria-hidden="true" tabindex="-1"></a>We created two models using the provided metrics for the integrated and DM-SNR profiles. The first model using integrated profile predictors yielded an accuracy of 96% for all predicted classes. The second model using the DM-SNR curve predictors had a lower accuracy at 91% for all predicted classes. In addition to better overall accuracy, the integrated curve model was also more accurate when predicting true positives (i.e. correctly identifying pulsar stars). Out of 219 pulsar stars in our data set, the integrated curve model correctly identified 178 (78%), compared with the DM-SNR curve model which only identified 127 (58%). Clearly, the integrated model is better than the DM-SNR curve model at predicting pulsar stars from the noise of space. However, considering how rare pulsar stars are an 81% accuracy of our best model may not be good enough if it is to be used in scientific research. To elucidate this, we calculated a false positive rate for each model, as falsely identifying a non-pulsar as a pulsar star affects the quality of future research far more than missing a pulsar star due to a false negative. Our integrated model had a false positive rate of 1.2%, while our DM-SNR model had a false positive rate of 4.2%. So again we see our integrated model is better at distinguishing pulsar stars, would give better prediction accuracy for our key metrics, and is a better choice for use in classifying new stars.</span>
<span id="cb39-519"><a href="#cb39-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-520"><a href="#cb39-520" aria-hidden="true" tabindex="-1"></a>By predicting the target class for each observation in the testing data set using the integrated model, we accurately differentiated pulsars from non-pulsars for each observation in the testing data set and could predict the class of recently recorded pulsar observations.</span>
<span id="cb39-521"><a href="#cb39-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-522"><a href="#cb39-522" aria-hidden="true" tabindex="-1"></a>Contrary to our hypothesis that the DM-SNR curve model would be more accurate, the integrated profile model proved to be better at predicting pulsars. The reasoning for our hypothesis was that the DM-SNR curve would be a better preprocessing method which removed distortions in pulse shapes due to dispersion, in comparison to the integrated pulse profile which preprocessed the time series by folding the data with respect to the rotational period. Analyzing the integrated vs DM-SNR model's accuracies tells us how well these recording methods can identify a pulsar star and the best variables for filtering pulsar stars from the noise of space. We used the integrated model to predict the target class for the observations in the testing dataset, differentiating pulsar stars from non-pulsars. Prediction of pulsars will be beneficial for scientists and astronomers for celestial research. Using pulsar stars, scientists can measure cosmic distances, time and search for planets beyond Earth's solar system. Moreover, it is possible to measure how the presence of massive bodies curves space-time. By observing pulsars, the researchers have shown repeatedly that close double neutron star systems send out strong gravitational waves (Cofield 2016). Helping scientists efficiently and accurately identify pulsar stars will ultimately help advance research areas that depend on pulsar stars.</span>
<span id="cb39-523"><a href="#cb39-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-524"><a href="#cb39-524" aria-hidden="true" tabindex="-1"></a>Now that we have demonstrated a reasonably effective model using the provided data set, the next step would be to test our model out in the real world. This will give us a better idea of how useful our model might actually be to scientists interested in identifying pulsar stars, as the competition data set we used for our model may not be entirely representative of the data typically produced by radio telescopes. We may find that additional cleaning or wrangling is needed in order to deploy our model on real-world data.</span>
<span id="cb39-525"><a href="#cb39-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-526"><a href="#cb39-526" aria-hidden="true" tabindex="-1"></a>At the end of the data analysis, several questions may arise: - Are either of our models accurate enough for scientific research? - Is another classification model better suited to this data (e.g. Random Forest)? - Which predictors need more scientific advancement until they are as useful as the others? - Our best values of K were quite low. Do we need to omit variables that are adding extra variation into our models? - How accurate are the predicted labels from the model? - Can we further improve the model or method of classification?</span>
<span id="cb39-527"><a href="#cb39-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-528"><a href="#cb39-528" aria-hidden="true" tabindex="-1"></a><span class="fu">## Works cited</span></span>
<span id="cb39-529"><a href="#cb39-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-530"><a href="#cb39-530" aria-hidden="true" tabindex="-1"></a>Cofield,C.(2016, April 22). What Are Pulsars? . https://www.space.com/32661-pulsars.html</span>
<span id="cb39-531"><a href="#cb39-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-532"><a href="#cb39-532" aria-hidden="true" tabindex="-1"></a>Grootjans et al. (2016, August). Detection of Dispersed Pulsars in a Time Series by Using a Matched Filtering Approach. https://essay.utwente.nl/71435/1/GROOTJANS_MA_EWI.pdf</span>
<span id="cb39-533"><a href="#cb39-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-534"><a href="#cb39-534" aria-hidden="true" tabindex="-1"></a>Goldberger, A. (2019, January 04). Classifying pulsar stars using AI techniques. https://medium.com/duke-ai-society-blog/classifying-pulsar-stars-using-ai-techniques-d2be70c0f691</span>
<span id="cb39-535"><a href="#cb39-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-536"><a href="#cb39-536" aria-hidden="true" tabindex="-1"></a>Max Planck Institute, PULSE: The Impact of European Pulsar Science on Modern Physics, https://phys.org/news/2005-12-pulse-impact-european-pulsar-science.html</span>
<span id="cb39-537"><a href="#cb39-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-538"><a href="#cb39-538" aria-hidden="true" tabindex="-1"></a>(n.d.). Ggplot2 violin plot : Quick start guide - R software and data visualization. STHDA. http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization</span>
<span id="cb39-539"><a href="#cb39-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-540"><a href="#cb39-540" aria-hidden="true" tabindex="-1"></a>(n.d.). Violin Plot. Ggplot 2. https://ggplot2.tidyverse.org/reference/geom_violin.html</span>
<span id="cb39-541"><a href="#cb39-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-542"><a href="#cb39-542" aria-hidden="true" tabindex="-1"></a>Rodriguez, F. (2019, October 07). Pulsar Stars Detection. https://datauab.github.io/pulsar_stars/</span>
<span id="cb39-543"><a href="#cb39-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-544"><a href="#cb39-544" aria-hidden="true" tabindex="-1"></a>Liu K., (2017, June 26).Introduction to Pulsar, Pulsar Timing, and measuring of Pulse Time-of-Arrivals. http://ipta.phys.wvu.edu/files/student-week-2017/IPTA2017_KuoLiu_pulsartiming.pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>